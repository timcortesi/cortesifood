_.mixin({score:function(t,e,r){if(r=r||0,0===e.length)return.9;if(e.length>t.length)return 0;for(var n=e.length;n>0;n--){var i=e.substring(0,n),o=t.indexOf(i);if(!(o<0)&&!(o+e.length>t.length+r)){var s=t.substring(o+i.length),a=null;a=n>=e.length?"":e.substring(n);var l=_.score(s,a,r+o);if(l>0){var h=t.length-s.length;if(0!==o){var u=t.charCodeAt(o-1);if(32==u||9==u)for(var c=o-2;c>=0;c--)h-=32==(u=t.charCodeAt(c))||9==u?1:.15;else h-=o}return h+=l*s.length,h/=t.length}}}return!1},csvToArray:function(t){for(var e=function(t){if(null!=t)for(var e=0;e<t.length;e++)'"'==t[e][0]&&'"'==t[e][t[e].length-1]&&(t[e]=t[e].substr(1,t[e].length-2)),t[e]=t[e].split('""').join('"');return t},r=t.split(/\r?\n/),n=e(r.shift().match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g)),i=[];r.length;){var o=e(r.shift().match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g));if(null!==o){var s=_.zipObject(n,o);i.push(s)}}return i},csvify:function(t,e,r){var n='"'+_.map(e,"label").join('","')+'"\n';labels=_.map(e,"name");var i=_.zipObject(labels,_.map(labels,(function(){return""})));n+=_.map(t,(function(t){return JSON.stringify(_.map(_.values(_.extend(i,_.pick(t,labels))),(function(t){return"string"==typeof t?t.split('"').join('""'):_.isArray(t)?t.join():t})))}),this).join("\n").replace(/(^\[)|(\]$)/gm,"");var o=document.createElement("a");return o.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(n)),o.setAttribute("download",(r||"GrapheneDataGrid")+".csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o),!0}});var CSVParser=function(){"use strict";function t(t){(!1===this.options.ignoreEmpty||t.some((function(t){return 0!==t.length})))&&this.rows.push(t)}function e(t,e){var r={fieldSeparator:",",strict:!0,ignoreEmpty:!0};void 0===e&&(e={}),this.options={},Object.keys(r).forEach((function(t){this.options[t]=void 0===e[t]?r[t]:e[t]}),this),this.rows=[],this.data=t}return e.prototype.toString=function(){return"[object CSVParser]"},e.prototype.numberOfRows=function(){return this.rows.length},e.prototype.parse=function(){for(var e,r,n="(\\"+this.options.fieldSeparator+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+this.options.fieldSeparator+"\\r\\n]*))",i=new RegExp(n,"gi"),o=new RegExp('""',"g"),s=[],a=null;a=i.exec(this.data);)(e=a[1]).length&&e!=this.options.fieldSeparator&&(t.apply(this,[s]),s=[]),r=a[2]?a[2].replace(o,'"'):a[3],s.push(r);if(t.apply(this,[s]),!0===this.options.strict&&!this.rows.every((function(t){return t.length===this.length}),this.rows[0]))throw new Error("Invalid CSV data. Strict mode requires all rows to have the same number of fields. You can override this by passing `strict: false` in the CSVParser options")},e}();
